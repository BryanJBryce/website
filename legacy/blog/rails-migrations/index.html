<!DOCTYPE html>
<html>
  <head>
    <title>Rails Migrations | Dennis Reimann, Softwareentwickler</title>
    <script src='/javascripts/head.min.js'></script>
    <script type='text/javascript'>
      //<![CDATA[
        head.js(
          "https://ajax.googleapis.com/ajax/libs/jquery/1.7.0/jquery.min.js",
          "http://www.google-analytics.com/ga.js",
          "/fancybox/jquery.fancybox-1.3.4.pack.js",
          "/fancybox/jquery.easing-1.3.pack.js",
          "/javascripts/website.js",
          function(){Website.init()});
      //]]>
    </script>
    <link href='/atom.xml' rel='alternate' title='//dennisreimann' type='application/atom+xml' />
    <link href='/stylesheets/print.css' media='print' rel='stylesheet' type='text/css' />
    <link href='/stylesheets/screen.css' media='screen, projection' rel='stylesheet' type='text/css' />
    <link href='http://dennisreimann.de/blog/rails-migrations' rel='canonical' />
    <link href='http://openid.dennisreimann.de/server' rel='openid2.provider openid.server' />
    <link href='http://openid.dennisreimann.de/dennisreimann' rel='openid2.local_id openid.delegate' />
    <!--[if IE]>
      <link href='/stylesheets/ie.css' media='screen, projection' rel='stylesheet' type='text/css' />
    <![endif]-->
    <meta content='text/html; charset=UTF-8' http-equiv='Content-Type' />
    <meta content='BRi3ql7JvxxFP2KtBRHIV6Rfzn0ZN7xJF1NNtnEUaI8' name='google-site-verification' />
    <meta content='app-id=669642611,affiliate-data=10l5ET' name='apple-itunes-app' />
    <meta content='Migrations sind ein sehr kooles Feature, welches Rails seit Version 1.0 bietet: Anstatt das Datenbankschema als einfachen Dump (bspw. MySQL) zu definieren, kann man ein Migrationsfile schreiben, in dem die Tabellenstruktur Datenbank unabhängig festgehalten ist.' name='description' />
    <meta content='Ruby on Rails' name='keywords' />
  </head>
  <body>
    <div id="header">
      <div id='identity'>
        <a href='/' id='logo'>
          <span id='slashes'>//</span>
          <span id='name'>dennisreimann</span>
        </a>
        <div id='claim'>
          Softwareentwickler
        </div>
      </div>
    </div>
    <div id="main">
      <article>
        <header>
          <time class='pubdate' datetime='2006-12-11T19:05:00+01:00'>
            <div class='top'>Dec '06</div>
            <div class='day'>11</div>
          </time>
          <h1>Rails Migrations</h1>
        </header>
        <div class='content'><p>Migrations sind ein sehr kooles Feature, welches Rails seit Version 1.0 bietet: Anstatt das Datenbankschema als einfachen Dump zu definieren, kann man ein Migrationsfile schreiben, in dem die Tabellenstruktur Datenbank unabhängig festgehalten ist.</p>&#x000A;&#x000A;<!--more-->&#x000A;&#x000A;&#x000A;<p>Neben dem Vorteil, dass man mit Migrations nicht mehr an einen Datenbanktyp gebunden ist (bspw. MySQL), bringen sie auch automatisch weitere Vorteile mit sich: Da Migrationen kaskadierend aufeinander aufbauen (Initiale Migration, Version 1, Version 2, &#8230;) kann man das Schema versionenspezifisch erweitern und so ganz einfach zu den verschiedenen Anwendungsversionen migrieren.</p>&#x000A;&#x000A;<p>Da bei den meisten Anwendungen das Datenbankschema schon stand, bevor dieses Feature eingeführt wurde, haben es die Entwickler sehr leicht gemacht, aus einer bestehenden Datenbankstruktur ein Schema zu extrahieren. Mit dem Befehl<code>rake db:schema:dump</code> kann man sich sein Migration-Schema generieren lassen.&#x000A;Da die Migration wie gesagt DB-Typ unabhängig ist, kann es sein, dass die Tabellen Felder enthalten, welche sich nicht auf alle Datenbanktypen mappen lassen. In meinem Fall war es so, dass ich in einer MySQL Datenbank den Feldtyp <code>SET</code> benötigte und Rake dann den ganzen betroffenen Table ausließ. Um das Problem zu umgehen, habe ich zunächst die betroffenen Spalten gelöscht, die Migration erstellt und anschließen meine <code>SET</code>-Felder als <a href="http://www.rubyonrailsblog.com/articles/2006/09/06/create-custom-column-types-in-rails-migrations">benutzerdefinierte Spalten</a> eingefügt - dadurch entfällt dann allerdings natürlich wieder die Datenbankunabhängigkeit.</p>&#x000A;&#x000A;<p>Letzter Schritt wäre dann, das erstellte Schema in die Migration einzufügen. Dazu erstellt man zunächst mit dem Befehl <code>ruby script/generate migration InitialSchema</code> die dafür benötigten Dateien. Anschließend kopiert man das Schema in die Methode <code>self.up</code> der Klasse <code>InitialSchema</code> (<code>db/001_initial_schema.rb</code>).&#x000A;In der Methode <code>self.down</code> kann man festlegen, welche Änderungen beim Versions-Downgrade verworfen werden sollen (bspw. <code>drop_table :beispieltabelle</code>).</p>&#x000A;&#x000A;<p>Wer jetzt erst eine neue Anwendung startet, kann seine Migration auch gleich selbst schreiben und braucht sich diese nicht generieren lassen - dazu das passende <a href="http://garrettsnider.backpackit.com/pub/367902">Rails Migration Cheat Sheet</a>.</p></div>
        <div class='follow'>
          <p>
            Guter Artikel? Folge mir auf
            <a class="twitter" href="https://twitter.com/dennisreimann">Twitter</a>
            oder
            <a class="github" href="https://github.com/dennisreimann">GitHub</a>
          </p>
        </div>
        <div class='teaser' id='iOctocat' itemscope='itemscope' itemtype='http://schema.org/SoftwareApplication'>
          <a href='http://ioctocat.com'>
            <img alt='iOS app for GitHub' itemprop='image' src='/images/ioctocat.png' />
          </a>
          <h3 itemprop='name'>
            <a href='http://ioctocat.com'>iOctocat</a>
          </h3>
          <p itemprop='description'>
            ist GitHub für die Hosentasche - deine Projekte und das was dort passiert
            immer dabei mit deinem
            <span itemprop='device'>iPhone und iPod Touch.</span>
            <br />
            Die App ist
            <a href="http://ioctocat.com/appstore-iphone" itemprop="url">im App Store erhältlich</a>
          </p>
          <link href='http://schema.org/SocialNetworkingApplication' itemprop='SoftwareApplicationCategory' />
        </div>
      </article>
    </div>
    <div id="footer">
      <div class='vcard' id='contact'>
        <span class='fn'>Dennis Reimann</span>
        <p class='adr'>
          <span class='street-address'>Ottjen-Alldag-Str. 32</span>
          <br />
          <span class='postal-code'>D-28277</span>
          <span class='locality'>Bremen</span>
        </p>
        <p>
          <span class='web'><a class="url" href="http://dennisreimann.de/" rel="me">dennisreimann.de</a></span>
          <br />
          <span class='mail'><a class="email" href="mailto:mail@dennisreimann.de" rel="me">mail@dennisreimann.de</a></span>
          <br />
          <span class='tel'>+49 (0)151 22 63 03 17</span>
        </p>
        <p>
          <small><a href="/contact">Kontaktdetails</a></small>
        </p>
        <ul class='social'>
          <li><a href="https://github.com/dennisreimann" rel="me">GitHub</a></li>
          <li><a href="https://twitter.com/dennisreimann" rel="me">Twitter</a></li>
          <li><a href="http://www.xing.com/profile/Dennis_Reimann5" rel="me">XING</a></li>
        </ul>
      </div>
    </div>
    <script type='text/javascript'>
      //<![CDATA[
        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-376258-21']);
        _gaq.push(['_gat._anonymizeIp']);
        _gaq.push(['_trackPageview']);

        (function() {
          var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
          ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
          (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ga);
        })();
      //]]>
    </script>
  </body>
</html>
